<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>408é¢˜åº“ç®¡ç†åå°</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #f5f7fa; padding: 2rem; }
    .container { max-width: 1000px; margin: 0 auto; }
    h1 { color: #333; margin-bottom: 1.5rem; text-align: center; }
    .nav { display: flex; gap: 1rem; margin-bottom: 2rem; justify-content: center; }
    .nav button { padding: 0.8rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; }
    .nav .active { background: #667eea; color: white; }
    .nav .inactive { background: white; color: #666; }

    /* æ·»åŠ é¢˜ç›®è¡¨å• */
    .form-card { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); margin-bottom: 2rem; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
    .form-group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: 0.5rem; color: #333; font-weight: 500; }
    input, select, textarea { width: 100%; padding: 0.8rem; border: 1px solid #e8e8e8; border-radius: 6px; font-size: 1rem; }
    textarea { resize: vertical; min-height: 80px; }
    .options-group { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .btn-submit { width: 100%; padding: 1rem; background: #667eea; color: white; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; margin-top: 1rem; }
    .btn-submit:hover { background: #5568d3; }

    /* é¢˜ç›®åˆ—è¡¨ */
    .question-list { display: flex; flex-direction: column; gap: 1rem; }
    .question-item { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
    .question-header { display: flex; justify-content: space-between; margin-bottom: 1rem; }
    .question-tag { background: #667eea15; color: #667eea; padding: 0.3rem 0.8rem; border-radius: 4px; font-size: 0.9rem; }
    .btn-delete { background: #fff2f0; color: #ff4d4f; border: 1px solid #ffccc7; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; }
    .btn-delete:hover { background: #ff4d4f; color: white; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ 408é¢˜åº“ç®¡ç†åå°</h1>
    
    <div class="nav">
      <button id="tabAdd" class="active" onclick="switchTab('add')">æ·»åŠ é¢˜ç›®</button>
      <button id="tabList" class="inactive" onclick="switchTab('list')">é¢˜ç›®åˆ—è¡¨</button>
    </div>

    <!-- æ·»åŠ é¢˜ç›®è¡¨å• -->
    <div id="addSection">
      <div class="form-card">
        <div class="form-row">
          <div class="form-group">
            <label>å¹´ä»½</label>
            <input type="number" id="year" placeholder="ä¾‹å¦‚ï¼š2025">
          </div>
          <div class="form-group">
            <label>ç§‘ç›®</label>
            <select id="subject">
              <option value="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</option>
              <option value="è®¡ç®—æœºç»„æˆåŸç†">è®¡ç®—æœºç»„æˆåŸç†</option>
              <option value="æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</option>
              <option value="è®¡ç®—æœºç½‘ç»œ">è®¡ç®—æœºç½‘ç»œ</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>é¢˜å¹²</label>
          <textarea id="question" placeholder="è¯·è¾“å…¥é¢˜ç›®å†…å®¹"></textarea>
        </div>
        <div class="options-group">
          <div class="form-group">
            <label>é€‰é¡¹A</label>
            <input type="text" id="optionA" placeholder="é€‰é¡¹Aå†…å®¹">
          </div>
          <div class="form-group">
            <label>é€‰é¡¹B</label>
            <input type="text" id="optionB" placeholder="é€‰é¡¹Bå†…å®¹">
          </div>
          <div class="form-group">
            <label>é€‰é¡¹C</label>
            <input type="text" id="optionC" placeholder="é€‰é¡¹Cå†…å®¹">
          </div>
          <div class="form-group">
            <label>é€‰é¡¹D</label>
            <input type="text" id="optionD" placeholder="é€‰é¡¹Då†…å®¹">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>æ­£ç¡®ç­”æ¡ˆ</label>
            <select id="answer">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
            </select>
          </div>
          <div class="form-group">
            <label>éš¾åº¦</label>
            <select id="difficulty">
              <option value="ç®€å•">ç®€å•</option>
              <option value="ä¸­ç­‰">ä¸­ç­‰</option>
              <option value="å›°éš¾">å›°éš¾</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>ç­”æ¡ˆè§£æ</label>
          <textarea id="analysis" placeholder="è¯·è¾“å…¥ç­”æ¡ˆè§£æ"></textarea>
        </div>
        <button class="btn-submit" onclick="addQuestion">âœ… æ·»åŠ é¢˜ç›®</button>
      </div>
    </div>

    <!-- é¢˜ç›®åˆ—è¡¨ -->
    <div id="listSection" style="display: none;">
      <div class="question-list" id="questionList"></div>
    </div>
  </div>

  <script>
    const API = '/api/questions'

    // åˆ‡æ¢æ ‡ç­¾
    function switchTab(tab) {
      document.getElementById('addSection').style.display = tab === 'add' ? 'block' : 'none'
      document.getElementById('listSection').style.display = tab === 'list' ? 'block' : 'none'
      document.getElementById('tabAdd').className = tab === 'add' ? 'active' : 'inactive'
      document.getElementById('tabList').className = tab === 'list' ? 'active' : 'inactive'
      if (tab === 'list') loadQuestions()
    }

    // æ·»åŠ é¢˜ç›®
    async function addQuestion() {
      const question = {
        year: document.getElementById('year').value,
        subject: document.getElementById('subject').value,
        question: document.getElementById('question').value,
        options: [
          'A. ' + document.getElementById('optionA').value,
          'B. ' + document.getElementById('optionB').value,
          'C. ' + document.getElementById('optionC').value,
          'D. ' + document.getElementById('optionD').value
        ],
        answer: document.getElementById('answer').value,
        analysis: document.getElementById('analysis').value,
        difficulty: document.getElementById('difficulty').value
      }

      if (!question.question || !document.getElementById('optionA').value) {
        alert('è¯·å¡«å†™å®Œæ•´é¢˜ç›®å’Œé€‰é¡¹ï¼')
        return
      }

      try {
        const res = await fetch(API, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(question)
        })
        await res.json()
        alert('âœ… æ·»åŠ æˆåŠŸï¼')
        // æ¸…ç©ºè¡¨å•
        document.querySelectorAll('input, textarea').forEach(el => el.value = '')
      } catch (err) {
        alert('æ·»åŠ å¤±è´¥ï¼š' + err.message)
      }
    }

    // åŠ è½½é¢˜ç›®åˆ—è¡¨
    async function loadQuestions() {
      const res = await fetch(API)
      const questions = await res.json()
      const list = document.getElementById('questionList')
      list.innerHTML = questions.map(q => `
        <div class="question-item">
          <div class="question-header">
            <span class="question-tag">${q.year}å¹´ | ${q.subject} | ${q.difficulty}</span>
            <button class="btn-delete" onclick="deleteQuestion(${q.id})">åˆ é™¤</button>
          </div>
          <div style="color: #333; font-weight: 500; margin-bottom: 0.5rem;">${q.question}</div>
          <div style="color: #666; font-size: 0.9rem;">æ­£ç¡®ç­”æ¡ˆï¼š${q.answer}</div>
        </div>
      `).join('')
    }

    // åˆ é™¤é¢˜ç›®
    async function deleteQuestion(id) {
      if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™é“é¢˜å—ï¼Ÿ')) return
      await fetch(`${API}/${id}`, { method: 'DELETE' })
      alert('âœ… åˆ é™¤æˆåŠŸï¼')
      loadQuestions()
    }
  </script>
</body>
</html>